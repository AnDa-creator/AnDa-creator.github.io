<svg xmlns="http://www.w3.org/2000/svg" width="1550" height="520">

  <!-- Background -->
  <rect x="0" y="0" width="1550" height="520" fill="white"></rect>

  <!-- Layer labels -->
  <text x="10" y="100" font-size="16">M11</text>
  <text x="10" y="220" font-size="16">M10</text>
  <text x="10" y="340" font-size="16">M9</text>

  <!-- ================= TSV ================= -->
  <rect x="90" y="60" width="40" height="360" rx="20" ry="20" fill="#bbbbbb" stroke="black"></rect>
  <rect x="96" y="66" width="28" height="348" rx="14" ry="14" fill="#d47c2c"></rect>
  <text x="85" y="45" font-size="14">TSV</text>

  <!-- ================= Guard Ring ================= -->
  <rect x="150" y="60" width="16" height="360" fill="#e6ffe6" stroke="green" stroke-width="2"></rect>
  <rect x="220" y="60" width="16" height="360" fill="#e6ffe6" stroke="green" stroke-width="2"></rect>
  <text x="150" y="45" font-size="14" fill="green">GR (floating)</text>

  <!-- GR vias -->
  <rect x="166" y="90" width="12" height="12" fill="green"></rect>
  <rect x="236" y="90" width="12" height="12" fill="green"></rect>
  <rect x="166" y="210" width="12" height="12" fill="green"></rect>
  <rect x="236" y="210" width="12" height="12" fill="green"></rect>
  <rect x="166" y="330" width="12" height="12" fill="green"></rect>
  <rect x="236" y="330" width="12" height="12" fill="green"></rect>

  <!-- ================= Victim (INSIDE) ================= -->
  <rect x="280" y="80" width="220" height="40" fill="#99ccff" stroke="black"></rect>
  <text x="290" y="105" font-size="14">victim_net (M11)</text>

  <!-- ================= Attackers (OUTSIDE) ================= -->
  <rect x="620" y="200" width="220" height="40" fill="#ff9999" stroke="black"></rect>
  <text x="630" y="225" font-size="14">attacker_net_4 (M10)</text>

  <rect x="900" y="200" width="220" height="40" fill="#ff9999" stroke="black"></rect>
  <text x="910" y="225" font-size="14">attacker_net_0 (M10)</text>

  <rect x="900" y="320" width="220" height="40" fill="#ff9999" stroke="black"></rect>
  <text x="910" y="345" font-size="14">attacker_net_2 (M9)</text>

  <!-- ================= Capacitance buckets ================= -->

  <!-- Attacker -> GR (stolen Cc) -->
  <line x1="730" y1="200" x2="230" y2="200" stroke="red" stroke-width="2" marker-end="url(#arrow)"></line>
  <text x="420" y="185" font-size="13" fill="red">
    Cc (attacker → GR) ↑↑
  </text>

  <!-- Attacker -> Victim (reduced Cc) -->
  <line x1="730" y1="200" x2="500" y2="100" stroke="red" stroke-width="2" stroke-dasharray="6,6" marker-end="url(#arrow)"></line>
  <text x="540" y="140" font-size="13" fill="red">
    Cc (attacker → victim) ↓
  </text>

  <!-- Victim -> GR (large Cg) -->
  <line x1="280" y1="100" x2="230" y2="120" stroke="blue" stroke-width="3" marker-end="url(#arrow)"></line>
  <text x="260" y="150" font-size="13" fill="blue">
    Cg (victim → GR) ↑↑
  </text>

  <!-- TSV shielded -->
  <line x1="130" y1="260" x2="170" y2="260" stroke="black" stroke-width="2"></line>
  <text x="135" y="280" font-size="13">
    TSV shielded by GR
  </text>

  <!-- Arrow definition -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="black"></path>
    </marker>
  </defs>

</svg>
